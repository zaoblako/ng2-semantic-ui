{"version":3,"file":"collapse.js","sourceRoot":"","sources":["../../../../src/modules/collapse/directives/collapse.ts"],"names":[],"mappings":"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","sourcesContent":["import { Directive, ElementRef, Input, HostBinding, Renderer2 } from \"@angular/core\";\n\n@Directive({\n    selector: \"[suiCollapse]\"\n})\nexport class SuiCollapse {\n    // Set when the collapse is open, and not animating.\n    @HostBinding(\"class.expanded\")\n    private _isExpanded:boolean;\n\n    // Set when the collapse is closed, and not animating.\n    @HostBinding(\"class.collapsed\")\n    private get _isCollapsed():boolean {\n        return !this._isExpanded && !this._isCollapsing;\n    }\n\n    // Set when the collapse is animating.\n    @HostBinding(\"class.collapsing\")\n    private _isCollapsing:boolean;\n\n    // Flag that is initially true, to make the 1st animation instantaneous.\n    private _pristine:boolean;\n\n    @Input()\n    public get suiCollapse():boolean {\n        return this._isExpanded;\n    }\n\n    // Sets the state of the collapse, `true` is collapsed.\n    public set suiCollapse(value:boolean) {\n        if (value) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n\n    @Input()\n    public collapseDuration:number;\n\n    private get _animationDuration():number {\n        return this._pristine ? 0 : this.collapseDuration;\n    }\n\n    public constructor(private _element:ElementRef, private _renderer:Renderer2) {\n        this._pristine = true;\n\n        // Collapse animation duration is 350ms by default.\n        this.collapseDuration = 350;\n\n        this._isExpanded = false;\n        this._isCollapsing = false;\n    }\n\n    public hide():void {\n        this._isCollapsing = true;\n        this._isExpanded = false;\n\n        // Forcibly hide the overflow so that content is not visible past the boundaries of its container.\n        this._renderer.setStyle(this._element.nativeElement, \"overflow\", \"hidden\");\n\n        // Animate the host element from its scroll height to 0.\n        this.animate(this._element.nativeElement.scrollHeight, 0, false, () => {\n            this._isCollapsing = false;\n        });\n    }\n\n    public show():void {\n        this._isCollapsing = true;\n\n        // Animate the host element from its offset height to its scroll height.\n        this.animate(this._element.nativeElement.offsetHeight, this._element.nativeElement.scrollHeight, true, () => {\n            // Remove the overflow override to enable user styling once again.\n            this._renderer.removeStyle(this._element.nativeElement, \"overflow\");\n\n            this._isCollapsing = false;\n            this._isExpanded = true;\n        });\n    }\n\n    private animate(startHeight:number, endHeight:number, removeOnComplete:boolean = false, callback:() => void = () => {}):void {\n        const heightFrames = [\n            {\n                offset: 0,\n                height: `${startHeight}px`\n            },\n            {\n                offset: 1,\n                height: `${endHeight}px`\n            }\n        ];\n\n        if (removeOnComplete) {\n            heightFrames.push({\n                offset: 1,\n                height: `auto`\n            });\n        }\n\n        // Animate the collapse using the web animations API.\n        // Using directly because Renderer2 doesn't have invokeElementMethod method anymore.\n        this._element.nativeElement.animate(\n            heightFrames,\n            {\n                delay: 0,\n                // Disable animation on 1st collapse / expansion.\n                duration: this._animationDuration,\n                iterations: 1,\n                easing: \"ease\",\n                fill: \"both\"\n            }\n        );\n\n        if (this._pristine) {\n            // Remove pristine flag when first hit.\n            this._pristine = false;\n        }\n\n        setTimeout(() => callback(), this.collapseDuration);\n    }\n}\n"]}