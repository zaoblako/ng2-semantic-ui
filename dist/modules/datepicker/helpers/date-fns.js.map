{"version":3,"file":"date-fns.js","sourceRoot":"","sources":["../../../../src/modules/datepicker/helpers/date-fns.ts"],"names":[],"mappings":"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","sourcesContent":["import { IDatepickerLocaleValues } from \"../../../behaviors/localization/index\";\nimport { format, parse } from \"date-fns\";\nimport * as defaultLocale from \"date-fns/locale/en-US\";\n\ninterface IDateFnsLocaleValues { [name:string]:string[]; }\ninterface IDateFnsHelperOptions { type?:string; }\ntype DateFnsHelper<U, T> = (value:U, options:IDateFnsHelperOptions) => T;\ntype DateFnsWeekStartsOn = 0 | 1 | 2 | 3 | 4 | 5 | 6;\n\ninterface IDateFnsCustomLocale {\n    localize:{\n        weekday:DateFnsHelper<number, string>;\n        weekdays:DateFnsHelper<IDateFnsHelperOptions, string[]>;\n        month:DateFnsHelper<number, string>;\n        months:DateFnsHelper<IDateFnsHelperOptions, string[]>;\n        timeOfDay:DateFnsHelper<number, string>;\n        timesOfDay:DateFnsHelper<IDateFnsHelperOptions, string[]>;\n    };\n    match:{\n        weekdays:DateFnsHelper<string, RegExpMatchArray | null>;\n        weekday?:DateFnsHelper<RegExpMatchArray, number>;\n        months:DateFnsHelper<string, RegExpMatchArray | null>;\n        month?:DateFnsHelper<RegExpMatchArray, number>;\n        timesOfDay:DateFnsHelper<string, RegExpMatchArray | null>;\n        timeOfDay?:DateFnsHelper<RegExpMatchArray, number>;\n    };\n    options?:{\n        weekStartsOn?:number;\n    };\n}\n\nfunction buildLocalizeFn(values:IDateFnsLocaleValues,\n                         defaultType:string,\n                         indexCallback?:(oldIndex:number) => number):DateFnsHelper<number, string> {\n\n    return (dirtyIndex:number, { type } = { type: defaultType }) => {\n        const index = indexCallback ? indexCallback(dirtyIndex) : dirtyIndex;\n        return values[type][index];\n    };\n}\n\nfunction buildLocalizeArrayFn(values:IDateFnsLocaleValues, defaultType:string):DateFnsHelper<IDateFnsHelperOptions, string[]> {\n    return ({ type } = { type: defaultType }) => values[type];\n}\n\nfunction buildMatchFn(patterns:IDateFnsLocaleValues, defaultType:string):DateFnsHelper<string, RegExpMatchArray | null> {\n    return (dirtyString, { type } = { type: defaultType }) =>\n        dirtyString.match(`^(${patterns[type].join(\"|\")})`);\n}\n\nfunction buildParseFn(patterns:IDateFnsLocaleValues, defaultType:string):DateFnsHelper<RegExpMatchArray, number> {\n    return ([, result], { type } = { type: defaultType }) =>\n        (patterns[type] || patterns[defaultType])\n            .map(p => new RegExp(`^${p}`))\n            .findIndex(pattern => pattern.test(result));\n}\n\nexport class DateFnsParser {\n    private _weekStartsOn:DateFnsWeekStartsOn;\n    private _locale:IDateFnsCustomLocale;\n\n    private get _config():any {\n        return {\n            weekStartsOn: this._weekStartsOn,\n            locale: this._locale\n        };\n    }\n\n    constructor(locale:IDatepickerLocaleValues) {\n        this._weekStartsOn = locale.firstDayOfWeek as DateFnsWeekStartsOn;\n\n        const weekdayValues = {\n            long: locale.weekdays,\n            short: locale.weekdaysShort,\n            narrow: locale.weekdaysNarrow\n        };\n\n        const monthValues = {\n            long: locale.months,\n            short: locale.monthsShort\n        };\n\n        const timeOfDayValues = {\n            long: locale.timesOfDay,\n            uppercase: locale.timesOfDayUppercase,\n            lowercase: locale.timesOfDayLowercase\n        };\n\n        const timeOfDayMatchValues = {\n            long: locale.timesOfDay,\n            short: locale.timesOfDayUppercase.concat(locale.timesOfDayLowercase)\n        };\n\n        this._locale = defaultLocale as any;\n        this._locale.localize = {\n            ...this._locale.localize,\n            ...{\n                weekday: buildLocalizeFn(weekdayValues, \"long\"),\n                weekdays: buildLocalizeArrayFn(weekdayValues, \"long\"),\n                month: buildLocalizeFn(monthValues, \"long\"),\n                months: buildLocalizeArrayFn(monthValues, \"long\"),\n                timeOfDay: buildLocalizeFn(timeOfDayValues, \"long\", (hours:number) => {\n                    return hours / 12 >= 1 ? 1 : 0;\n                }),\n                timesOfDay: buildLocalizeArrayFn(timeOfDayValues, \"long\")\n            }\n        };\n        this._locale.match = {\n            ...this._locale.match,\n            ...{\n                weekdays: buildMatchFn(weekdayValues, \"long\"),\n                weekday: buildParseFn(weekdayValues, \"long\"),\n                months: buildMatchFn(monthValues, \"long\"),\n                month: buildParseFn(monthValues, \"long\"),\n                timesOfDay:buildMatchFn(timeOfDayMatchValues, \"long\"),\n                timeOfDay:buildParseFn(timeOfDayMatchValues, \"long\")\n            }\n        };\n    }\n\n    public format(d:Date, f:string):string {\n        return format(d, f, this._config);\n    }\n\n    public parse(dS:string, f:string, bD:Date):Date {\n        return parse(dS, f, bD, this._config);\n    }\n}\n"]}